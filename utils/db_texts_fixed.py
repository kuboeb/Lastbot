from sqlalchemy import select
from database import BotText

async def get_text(key: str, session):
    """–ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∏–∑ –ë–î –ø–æ –∫–ª—é—á—É"""
    try:
        result = await session.execute(
            select(BotText).where(BotText.key == key)
        )
        text_obj = result.scalar_one_or_none()
        
        if text_obj:
            return text_obj.text
        else:
            # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ —Ç–µ–∫—Å—Ç—ã –µ—Å–ª–∏ –Ω–µ—Ç –≤ –ë–î
            default_texts = {
                'welcome_new': """üöÄ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!

–≠—Ç–æ –±–æ—Ç –¥–ª—è –∑–∞–ø–∏—Å–∏ –Ω–∞ –ë–ï–°–ü–õ–ê–¢–ù–´–ô –∫—É—Ä—Å –ø–æ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–µ –æ—Ç –≤–µ–¥—É—â–∏—Ö —ç–∫—Å–ø–µ—Ä—Ç–æ–≤ –∏–Ω–¥—É—Å—Ç—Ä–∏–∏!

üî• –ü–æ—á–µ–º—É —Å—Ç–æ–∏—Ç –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å:
- 100% –±–µ—Å–ø–ª–∞—Ç–Ω–æ - –Ω–∏–∫–∞–∫–∏—Ö —Å–∫—Ä—ã—Ç—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π
- –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞–Ω–∏—è - —Ä–µ–∞–ª—å–Ω—ã–µ –∫–µ–π—Å—ã –∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
- –õ–∏—á–Ω—ã–π –Ω–∞—Å—Ç–∞–≤–Ω–∏–∫ - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–∞ –≤—Å–µ—Ö —ç—Ç–∞–ø–∞—Ö
- –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ø–æ –æ–∫–æ–Ω—á–∞–Ω–∏–∏ –∫—É—Ä—Å–∞

üí∞ –ü–æ—Å–ª–µ –∫—É—Ä—Å–∞ –≤—ã —Å–º–æ–∂–µ—Ç–µ:
- –ó–∞—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–∞ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–µ –æ—Ç 500‚Ç¨ –≤ –º–µ—Å—è—Ü
- –°–æ–∑–¥–∞—Ç—å –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ—Ä—Ç—Ñ–µ–ª—å
- –ò–∑–±–µ–≥–∞—Ç—å —Ç–∏–ø–∏—á–Ω—ã—Ö –æ—à–∏–±–æ–∫ –Ω–æ–≤–∏—á–∫–æ–≤
- –ü–æ–Ω–∏–º–∞—Ç—å —Ä—ã–Ω–æ—á–Ω—ã–µ —Ç—Ä–µ–Ω–¥—ã

‚ö° –ú–µ—Å—Ç–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã! –û—Å—Ç–∞–ª–æ—Å—å –≤—Å–µ–≥–æ 17 –º–µ—Å—Ç –≤ –≥—Ä—É–ø–ø–µ.

–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ, —á—Ç–æ–±—ã –∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –º–µ—Å—Ç–æ üëá""",
                
                'welcome_back': """üëã –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!

–í–∞—à–∞ –∑–∞—è–≤–∫–∞ –Ω–∞ –∫—É—Ä—Å —É–∂–µ –ø—Ä–∏–Ω—è—Ç–∞. –°–∫–æ—Ä–æ —Å –≤–∞–º–∏ —Å–≤—è–∂–µ—Ç—Å—è –Ω–∞—à –º–µ–Ω–µ–¥–∂–µ—Ä.

üí∞ –•–æ—Ç–∏—Ç–µ –ø–æ–ª—É—á–∏—Ç—å 50‚Ç¨ –Ω–∞ —Å–≤–æ–π —Å—á–µ—Ç?
–ü—Ä–∏–≥–ª–∞—à–∞–π—Ç–µ –¥—Ä—É–∑–µ–π! –ò –≤—ã, –∏ –≤–∞—à –¥—Ä—É–≥ –ø–æ–ª—É—á–∏—Ç–µ –ø–æ 50‚Ç¨, –∫–æ–≥–¥–∞ –æ–Ω –ø—Ä–æ–π–¥–µ—Ç 50% –∫—É—Ä—Å–∞.

–í–∞—à–∞ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞:
{referral_link}"""
            }
            return default_texts.get(key, f"–¢–µ–∫—Å—Ç '{key}' –Ω–µ –Ω–∞–π–¥–µ–Ω")
            
    except Exception as e:
        print(f"Error getting text: {e}")
        return f"–¢–µ–∫—Å—Ç '{key}' –Ω–µ –Ω–∞–π–¥–µ–Ω"
